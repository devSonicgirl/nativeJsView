/*! jquery.nativeJsView.js v0.9 */
/*
 * This is a view template that uses native javascript code in HTML.
 * Requires jQuery 1.x or later.
 * See https://github.com/devSonicgirl/nativeJsView
 *
 * Copyright 2017, devSonicgirl
 * Released under the MIT License.
 */
var global_nativejsview_cell={};!function(t){"use strict";var e=function(t){this.init=e.prototype.init,this.init(t)};e.prototype={constructor:e,dom:"",js_id:null,script_vars:"",script_body:"",init:function(e){var r=e;t(r).attr("id")||t(r).attr("id","jv_"+(new Date).getTime()+parseInt(1e3*Math.random()).toString()),this.js_id=t(r).attr("id"),this.dom=t(r).html()},setjs:function(t,e){t&&("vars"==e?this.script_vars=this.script_vars.concat(t,"\n"):"body"==e&&(this.script_body=this.script_body.concat(t,"\n")))},vars_define:function(e){var r=this,i="vars";this.script_vars="",t.each(e,function(t,e){switch(typeof e){case"string":e=e.replace(/\"/g,'\\"'),e=e.replace(/\n/g," "),e=e.replace(/\r/g,""),r.setjs("var "+t+' = "'+e+'"',i);break;case"number":r.setjs("var "+t+" = "+e,i);break;case"boolean":r.setjs("var "+t+" = "+e,i);break;case"object":r.setjs("var "+t+" = "+JSON.stringify(e),i);break;case"function":}})},render:function(){var e="jv_render_"+(new Date).getTime(),r="body",i=this.dom;i=i.trim(),i=i.replace(/\n/gm,""),i=i.replace(/>\s+</gm,"><"),i=i.replace(/\&amp;/g,"\\&"),i=i.replace(/\&gt;/g,">"),i=i.replace(/\&lt;/g,"<"),i=i.replace(/\"/g,'\\"'),i=i.replace(/<!-{2,}=(.*?)-{2,}>/g,function(t,e){return e=e.replace(/\\"/g,'"'),'")\n'.concat("put_html(",e.trim(),")\n",'put_html("')}),i=i.replace(/<!-{2,}_(.*?)-{2,}>/g,function(t,e){return e=e.replace(/\\"/g,'"'),'")\n'.concat(e.trim(),"\n",'put_html("')}),this.setjs("var ".concat(e," = ''"),r),this.setjs("function put_html(html) { ".concat(e,"=",e,".concat(html)","}"),r),this.setjs('put_html("'.concat(i,'")'),r),this.setjs("if ( mode != 'append' ) {  $('#".concat(this.js_id,"').html(",e,") } else { $('#",this.js_id,"').append(",e,") }"),r),t("#"+this.js_id).html("")},call:function(e){var r=this.script_vars.concat(this.script_body);try{var i="mode='"+e+"'";new Function(i,r)()}catch(s){console.log("%cjv-error%c "+s,"background-color:#ff0000; color:#ffffff;","color:#000000"),t("#"+this.js_id).html("")}},refresh:function(t){this.vars_define(t),this.call()},append:function(t){this.vars_define(t),this.call("append")}},e.prototype.constructor=e,t.fn.nativeJsView=function(r){var i,s=this.attr("id");return"undefined"==typeof global_nativejsview_cell[s]?(i=new e(this),r?(i.vars_define(r),i.render(),i.call()):i.render(),s=t(this).attr("id"),global_nativejsview_cell[s]=i):(i=global_nativejsview_cell[s],r&&i.refresh(r)),i}}(jQuery);
