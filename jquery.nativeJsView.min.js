/*! jquery.nativeJsView.js v0.9 */
/*
 * This is a view template that uses native javascript code in HTML.
 * Requires jQuery 1.x or later.
 * See https://github.com/devSonicgirl/nativeJsView
 *
 * Copyright 2017, devSonicgirl
 * Released under the MIT License.
 */
var global_nativejsview_cell={};!function(t){"use strict";var e=function(t){this.init=e.prototype.init,this.init(t)};e.prototype={constructor:e,dom:"",js_id:null,script_vars:"",script_body:"",init:function(e){var i=e;t(i).attr("id")||t(i).attr("id","jv_"+(new Date).getTime()+parseInt(1e3*Math.random()).toString()),this.js_id=t(i).attr("id"),this.dom=t(i).html()},setjs:function(t,e){t&&("vars"==e?this.script_vars=this.script_vars.concat(t,"\n"):"body"==e&&(this.script_body=this.script_body.concat(t,"\n")))},vars_define:function(e){var i=this,r="vars";this.script_vars="",t.each(e,function(t,e){switch(typeof e){case"string":i.setjs("var "+t+' = "'+e.replace(/\"/g,'\\"')+'"',r);break;case"number":i.setjs("var "+t+" = "+e,r);break;case"boolean":i.setjs("var "+t+" = "+e,r);break;case"object":i.setjs("var "+t+" = "+JSON.stringify(e),r);break;case"function":}})},render:function(){var e="jv_render_"+(new Date).getTime(),i="body",r=this.dom;r=r.trim(),r=r.replace(/\n/gm,""),r=r.replace(/>\s+</gm,"><"),r=r.replace(/\&amp;/g,"\\&"),r=r.replace(/\&gt;/g,">"),r=r.replace(/\&lt;/g,"<"),r=r.replace(/\"/g,'\\"'),r=r.replace(/<!-{2,}=(.*?)-{2,}>/g,function(t,e){return e=e.replace(/\\"/g,'"'),'")\n'.concat("put_html(",e.trim(),")\n",'put_html("')}),r=r.replace(/<!-{2,}_(.*?)-{2,}>/g,function(t,e){return e=e.replace(/\\"/g,'"'),'")\n'.concat(e.trim(),"\n",'put_html("')}),this.setjs("var ".concat(e," = ''"),i),this.setjs("function put_html(html) { ".concat(e,"=",e,".concat(html)","}"),i),this.setjs('put_html("'.concat(r,'")'),i),this.setjs("if ( mode != 'append' ) {  $('#".concat(this.js_id,"').html(",e,") } else { $('#",this.js_id,"').append(",e,") }"),i),t("#"+this.js_id).html("")},call:function(e){var i=this.script_vars.concat(this.script_body);try{var r="mode='"+e+"'";new Function(r,i)()}catch(s){console.log("%cjv-error%c "+s,"background-color:#ff0000; color:#ffffff;","color:#000000"),t("#"+this.js_id).html("")}},refresh:function(t){this.vars_define(t),this.call()},append:function(t){this.vars_define(t),this.call("append")}},e.prototype.constructor=e,t.fn.nativeJsView=function(i){var r,s=this.attr("id");return"undefined"==typeof global_nativejsview_cell[s]?(r=new e(this),i?(r.vars_define(i),r.render(),r.call()):r.render(),s=t(this).attr("id"),global_nativejsview_cell[s]=r):(r=global_nativejsview_cell[s],i&&r.refresh(i)),r}}(jQuery);
